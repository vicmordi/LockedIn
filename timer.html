<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>LockedIn — Timer</title>
  <meta name="theme-color" content="#0f172a" />
  <link rel="stylesheet" href="timer.css" />
</head>
<body>
  <div class="app card">
    <header class="header">
      <div class="brand">
        <span class="dot"></span>
        <div>
          <h1>LockedIn</h1>
          <p class="muted">Tap the timer to toggle Focus Mode.</p>
        </div>
      </div>
      <nav class="nav">
        <a id="historyLink" class="pill" href="#">History</a>
        <a id="toggleSound" class="pill" href="#">Sound: On</a>
        <span id="wakelockStatus" class="pill">Screen lock: off</span>
      </nav>
    </header>

    <section id="timerPage" class="timer-layout">
      <!-- Main timer section -->
      <section class="panel panel-primary">
        <div class="clock-shell" id="clockShell" aria-hidden="true">
          <div
            class="timer"
            id="timer"
            role="button"
            tabindex="0"
            aria-label="Tap to toggle Focus Mode"
          >
            00:00:00
          </div>
        </div>

        <div class="phase-meta">
          <div class="sub" id="phaseLabel">Stay focused. You've got this.</div>
        </div>

        <!-- Primary controls -->
        <div class="controls-primary">
          <button id="focusModeBtn" class="btn btn-primary-action">Focus Mode</button>
          <button id="pauseResume" class="btn btn-secondary-action" disabled>Resume</button>
        </div>

        <!-- Secondary controls -->
        <div class="controls-secondary">
          <button id="endEarly" class="btn btn-ghost" disabled>End Session</button>
          <button id="emergencyBtn" class="btn btn-ghost">Emergency</button>
          <button id="reset" class="btn btn-ghost">Reset</button>
        </div>
      </section>

      <!-- Sidebar with session info and history -->
      <aside class="panel panel-secondary">
        <div class="section-heading">
          <label class="label">Session Info</label>
        </div>
        <div id="sessionInfo" class="session-info"></div>

        <div class="section-heading" style="margin-top:24px;">
          <label class="label">Recent Sessions</label>
        </div>
        <div id="history" class="history"></div>

        <div class="actions" style="margin-top:20px;">
          <a id="backToSetup" class="btn btn-ghost" href="#" style="width:100%;">Back to Setup</a>
        </div>
      </aside>
    </section>
  </div>

  <!-- PIN/Emergency sheet (overlay, no custom keypad) -->
  <div id="sheet" class="sheet" aria-hidden="true">
    <div class="sheet-inner" onclick="event.stopPropagation()">
      <span class="pill">Focus session</span>
      <h2 class="h2">PIN required</h2>
      <p class="note">Enter your LockedIn PIN to confirm this action.</p>

      <!-- Emergency shortcuts (populated from JS) -->
      <div class="emergency" id="emergencyLinks"></div>

      <!-- Use device keyboard, no on-screen keypad -->
      <input
        id="pinInput"
        type="password"
        inputmode="numeric"
        pattern="[0-9]*"
        placeholder="Enter your PIN"
        class="pinbox"
        autocomplete="one-time-code"
      />

      <div class="sheet-actions">
        <button id="submitPin" class="btn">Confirm</button>
        <button id="cancelSheet" class="btn btn-ghost">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Break Focus Confirmation Dialog -->
  <div id="breakFocusSheet" class="sheet break-focus-sheet" aria-hidden="true">
    <div class="sheet-inner break-focus-inner" onclick="event.stopPropagation()">
      <div class="break-focus-icon">!</div>
      <h2 class="h2">Break Focus?</h2>
      <p class="note">Are you sure you want to end your session early?</p>
      
      <div class="break-focus-reason">
        <label class="label" for="breakReason">Reason for ending early (optional)</label>
        <input
          id="breakReason"
          type="text"
          placeholder="e.g., urgent call, emerg"
          class="pinbox"
        />
      </div>

      <div class="sheet-actions">
        <button id="confirmBreak" class="btn btn-ghost break-wait-btn">Wait 4s...</button>
        <button id="cancelBreak" class="btn btn-ghost">Cancel</button>
      </div>
      
      <p class="break-focus-hint">Think twice. You're doing great.</p>
    </div>
  </div>

  <!-- Minimal countdown overlay (Focus Mode) -->
  <div id="minimal" class="minimal" aria-hidden="true">
    <div id="minimalTimer" class="minimalTimer">00:00:00</div>
    <!-- Menu button in fullscreen -->
    <button id="fullscreenMenuBtn" class="fullscreen-menu-btn" aria-label="Open menu">☰</button>
  </div>

  <!-- Fullscreen Menu -->
  <div id="fullscreenMenu" class="fullscreen-menu" aria-hidden="true">
    <div class="fullscreen-menu-content">
      <button id="exitFullscreenBtn" class="menu-item">Exit Focus Mode</button>
      <button id="pauseFromFullscreen" class="menu-item">Pause</button>
      <button id="endFromFullscreen" class="menu-item">End Session</button>
      <button id="emergencyFromFullscreen" class="menu-item">Emergency</button>
    </div>
  </div>

  <!-- Quotes toast container -->
  <div id="toasts" class="toasts" aria-live="polite" aria-atomic="true"></div>

  <script src="alerts.js"></script>
  <script src="timer.js"></script>
</body>
</html>
